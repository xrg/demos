{% extends "abb/base.html" %}

{% load i18n %}
{% load custom %}
{% load staticfiles %}

{% block css %}

<!-- audit.css -->
<link rel="stylesheet" href="{% static 'abb/audit.css' %}">

{% endblock css %}


{% block main %}

<div class="row">
	<div class="col-xs-12">
		
		{% tuple _("Election") election.id as t1 %}
		{% tuple _("Participants") participants as t2 %}
		{% tuple _("Verified") "<span class='glyphicon glyphicon-option-horizontal' aria-hidden='true'></span>" as t3 %}
		{% tuple t1 t2 t3 as panels %}
		{% include "common/election_box.html" with object=election panels=panels %}
		
		<div class="alert alert-warning text-center" role="alert">
			<h4>{% trans "Please enter your ballot's serial number" %}:</h4>
			<p class="text-center">
				<div class="form-inline">
					<div class="form-group"><input type="text" class="form-control text-center"></div>
					<button id="ballot-check" class="btn btn-default check-button" data-toggle="tooltip" data-placement="bottom" title="{% trans 'Input field is empty' %}">{% trans "Check" %}</button>
				</div>
			</p>
		</div>
		
		<div id="audit-box" class="hidden">
			
			<div class="panel with-nav-tabs panel-default">
				<div class="panel-heading">
					<ul class="nav nav-tabs nav-justified">
						{% for part in "ab" %}
						<li role="presentation" class="{% if forloop.first %}active{% endif %}">
							<a role="tab" data-toggle="tab" href="#part-{{ part }}">{% trans "Side" %} {{ part|upper }}</a>
						</li>
						{% endfor %}
					</ul>
				</div>
				<div class="panel-body">
					<div class="tab-content">
						{% for part in "ab" %}
						<div role="tabpanel" class="tab-pane fade {% if forloop.first %}active in{% endif %}" id="part-{{ part }}">
							{% for question in questions %}
							<div class="panel panel-default hidden">
								<div class="panel-heading">{% trans "Question" %}{% if questions|length > 1 %} {{ question.index|add:"1" }}{% endif %}: {{ question.text }}</div>
								<table class="table table-hover">
									<thead>
										<tr>
											<th>{% trans "Vote-code" %}</th>
											<th><span>{% trans "Vote" %}</span><span>{% trans "Option" %}</span></th>
											<th>{% trans "Pre-vote Audit" %}</th>
											<th>{% trans "Candidate" %}</th>
											<th>{% trans "Post-vote Audit" %}</th>
										</tr>
									</thead>
									<tbody>
										{% for option in question.optionc_set.values %}
										<tr data-text="{{ option.text }}">
											<td><button type="button" class="btn btn-info votecode"></button></td>
											<td><button type="button" class="btn btn-primary voted hidden"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button></d>
											<td><button type="button" class="btn btn-warning zk1"><span class="glyphicon glyphicon-folder-close" aria-hidden="true"></span></button></td>
											<td><button type="button" class="btn btn-danger com"><span class="glyphicon glyphicon-envelope" aria-hidden="true"></span></button></td>
											<td><button type="button" class="btn btn-success zk2"><span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span></button></td>
										</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>
							{% endfor %}
						</div>
						{% endfor %}
					</div>
				</div>
		</div>
		
	</div>
</div>

<div id="json-viewer" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">{% trans "JSON Viewer" %}</h4>
			</div>
			<div class="modal-body">
				<div class="spinner hidden">
					<p class="text-center">{% trans "Please wait..." %}</p>
				</div>
				<div class="error hidden">
					<p class="text-center">{% trans "An error occurred while processing your request" %}.</p>
				</div>
				<pre class="hidden">
				</pre>
			</div>
			<div class="modal-footer">
				<a class="btn btn-default" role="button"><span class="glyphicon glyphicon-save" aria-hidden="true"></span> {% trans "Download" %}</a>
				<button type="button" class="btn btn-default" data-dismiss="modal">{% trans "Close" %}</button>
			</div>
		</div>
	</div>
</div>

{% endblock main %}


{% block script %}

<!-- audit.js -->
<script src="{% static 'abb/audit.js' %}"></script>

{% endblock script %}
